<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <ul id="todoList"></ul>
</body>
<script>
    function getTodos() {
        fetch("https://jsonplaceholder.typicode.com/todos")
            .then(res => res.json())
            .then(data => appendTodos(data))
            .catch(err => console.log("Error:", err));
    }

    async function storeTodos() {
        try{
             document.getElementById("todoList").innerHTML = '<div class="loading">Loading todos...</div>';
            const response = await fetch("https://jsonplaceholder.typicode.com/todos")
            if(!response.ok) throw new Error('Failed to fetch')
            const allTodos = await response.json();
            const first20 = allTodos.slice(0,20);
            save();
            appendTodos();

        }catch(error){
            document.getElementById("todoList").innerHTML.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            
        }
    }

    function save(){
        localStorage.setItem('todos', JSON.stringify(first20));
    }

    function appendTodos() {
        const todos = getTodos()
        const list = document.getElementById("todoList");

        todos.forEach(item => {
            const li = document.createElement("li");
            li.textContent = item.title;
            list.appendChild(li);
        });
    }

  storeTodos();

</script>

</html>